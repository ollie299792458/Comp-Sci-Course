This review might have spoilers if you give it much thought but i prefer to say it merely will make you curious.
I sort of agree with what Uma Thurman says in her interview on the special features after the movie.  She did not care for the twist.  Nor did I.  But I only looked at the movie once.  To me this movie could have been a great psychological thriller without the twist.  It would have made logical sense and there would have been a very good explanation for the problems of the adult character Diane( to say too much about this would be a spoiler).  But with the twist the movie has some holes in it.  But viewers need to make their own assessment.  Do you want it to be a supernatural fantasy or a realistic exploration into a real life drama and the results of a life or death choice?  I would have given it 5 stars as a realistic movie without the twist.  The twist made the whole movie watching experience (for me) a disappointment.  Everything tied together so well without it.  I said to myself at the ending What the hell - this movie makes no sense and then it dawned on me what was done and I saw it as a bad choice.  But only after looking at the special features did i fully realize what they had done and why.  And even then i only really got it after hearing the interview of the young character Emma.  I would like to see it redone as a real drama without showing the choice made in the school bathroom.  I will say they did a good job hiding the twist and the hints weren't really apparent, which had to be tricky, and thus the potholes in the plot.  This could actually be two different movies - it all hinges on what choice is made at one point in the movie.