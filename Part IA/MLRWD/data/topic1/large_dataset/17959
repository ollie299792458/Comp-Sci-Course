Let me be up front with this, I did not like Shrek.  To me, the flatulence humor made it unfit for children, and other than that it was a one-note production, the running gag of the Disney bashing got real old, real fast.
But while this movie does continue the flatulence humor, it soft pedals (not eliminates) the Disney bashing, and gives us better production values, a more complex story, more developed characters, and a show stopper of a musical number (ironic, as it provides the soundtrack for the climatic action sequence).  Pop culture reference come faster than you can count, but they are genuinely funny.  
Antonio Banderas and Jennifer Saunders make this show, and I personally would be more interested in a Puss In Boots spinoff than a Shrek 3.  John Cleese is perfect as the King, the real hero of this piece, willing to sacrifice his Happily Ever After so that his daughter could have hers.
Again, I'm not sure this is appropriate for pre-teens, but teens and adults are in for a good time.