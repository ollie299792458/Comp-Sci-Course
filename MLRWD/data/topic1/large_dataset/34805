This is without a doubt a complex and dreamlike film which refuses to make things simple for the viewer.  Johnny Depp almost sleepwalks through this film and thats precisly the way this role needed to be played, ever so slightly detached from reality and leaving you wondering how real everything really is. Roman Polanski's wife Emmanuelle is suitably ambiguous and Lena Olin seductivly evil while Frank Langella is probably at his weakest and seriously overplays some of his scenes.  It seems that a lot of people are having real trouble understanding the end of this film.  I think its probably a case of it being one of those films which doesn't necessarily  set out everything on a silver platter for you and also is deliberatly ambigous.  What I'm going to say now is my take on it so obviously its full of spoilers but I will try to hold something back so people can watch it and make up there own minds.
The ending  -SPOILER- The riddle refered to in the pages of the book is supposed to conjour up the Devil in the flesh.  The faked  picture depicts the Whore of Babylon which is traditionally depicted as a woman riding on a Seven headed beast.  Depending on which interpretation of the Whore you read it could be a person, place, country or even a religion but in this case it appears the Whore is a person and a common reading of the passages is that the Whore is the precursor to the anti-christ.  This person was introduced with references to Witches and pacts with the Devil.  The true picture shown at the end shows the whore triumphant in front of a castle (the castle) with light streaming from the castle.  A scene a couple of minutes previously showed the castle in flames (light) and given the actions in the foreground it doesn't take a genius to figure out the way the Devil has found to make himself flesh.
I may be wrong with my reading of the ending of the film but it actually made perfect sense to me the first time I watched it but to tell the truth I think its one of those films that deliberatly wants you to question just what its ending really means.  I'd recommend this film to any Polanski fans, fans of occult films like the Omen, as well as fans of films without easy endings like Se7en.  I'd definitly warn off people who prefer their endings cut and dried or full of action.